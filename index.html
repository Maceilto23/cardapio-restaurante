<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CardÃ¡pio Interativo</title>
<style>
* { box-sizing: border-box; margin:0; padding:0; }
body { font-family: Arial, sans-serif; background: #f5f5f5; display: flex; flex-direction: column; align-items: center; padding: 10px; }
.cardapio { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 6px 15px rgba(0,0,0,0.2); max-width: 500px; width: 100%; margin-bottom: 20px; }
.logo-container { display: flex; align-items: center; justify-content: flex-start; margin-bottom: 20px; }
.logo-container img { height: 60px; margin-right: 15px; border-radius: 8px; }
.titulo-container h1 { font-size: 1.5rem; color: #007BFF; margin-bottom: 5px; }
.titulo-container h2 { font-size: 1.1rem; color: #555; font-weight: normal; }
.titulo-container h3 { font-size: 1rem; margin-bottom: 10px; color: #333; }
ul { list-style: none; padding: 0; }
li { margin: 5px 0; cursor: pointer; display: flex; align-items: center; padding: 6px 10px; border-radius: 8px; transition: background 0.2s; }
li:hover { background: #f0f0f0; }
.checkbox-fake { width: 22px; height: 22px; border: 2px solid #007BFF; display: flex; align-items: center; justify-content: center; margin-right: 10px; border-radius: 4px; font-weight: bold; color: #fff; background: #007BFF; opacity: 0; transition: opacity 0.2s, transform 0.2s; flex-shrink: 0; }
li.selected .checkbox-fake { opacity: 1; transform: scale(1.1); }
li span { flex: 1; }
#adicionais, input[type="text"], input[type="number"], select { width: 100%; padding: 8px; margin-top: 8px; border-radius: 6px; border: 1px solid #ccc; }
#enviarWhats, #gerarMarmitas { margin-top: 12px; padding: 10px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; font-size: 1rem; }
#gerarMarmitas { background: #007BFF; color: #fff; }
#enviarWhats { background: #25D366; color: #fff; }
.marmita-icons { display: flex; flex-wrap: wrap; margin-top: 10px; gap: 8px; }
.marmita-icon { width: 50px; height: 50px; background: #f0f0f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; border: 2px solid #ccc; transition: border 0.2s; }
.marmita-icon.selected { border-color: #007BFF; background: #e0f0ff; }
.marmita-choose { display: none; margin-top: 10px; padding: 10px; border: 1px solid #007BFF; border-radius: 8px; background: #f9f9f9; }
.marmita-options label { display:block; margin-bottom:6px; cursor:pointer; }
.marmita-options input { margin-right: 8px; }
@media (max-width: 600px) { 
  .logo-container { flex-direction: column; align-items: center; text-align: center; } 
  .logo-container img { margin-right: 0; margin-bottom: 8px; height: 50px; } 
  .titulo-container h1 { font-size: 1.3rem; } 
  .titulo-container h2 { font-size: 1rem; } 
  #enviarWhats, #gerarMarmitas { font-size: 0.95rem; } 
}
</style>
</head>
<body>

<div class="cardapio">
  <div class="logo-container">
    <img src="logo.png" alt="Logo Restaurante">
    <div class="titulo-container">
      <h1>Restaurante Colinas</h1>
      <h2>ğŸ½ï¸ CardÃ¡pio de Hoje â€“ <span id="diaSemana"></span>, <span id="dataHoje"></span></h2>
      <h3 id="horarioFuncionamento">HorÃ¡rio: --:-- - --:--</h3>
    </div>
  </div>

 <label for="quantidadeMarmitas">Quantidade de Marmitas:</label>
<input type="number" id="quantidadeMarmitas" min="1" max="20" value="1">
<button id="gerarMarmitas">Gerar Marmitas</button>

<div class="marmita-icons" id="marmitaIcons"></div>

<div class="marmita-choose" id="marmitaChoose">
  <h3>Escolha os itens da Marmita</h3>
  <div class="marmita-options"></div>
  <h3>ğŸ– Carnes</h3>
  <ul id="carnes"></ul>
  <h3>ğŸ¥— Acompanhamentos</h3>
  <ul id="acompanhamentos"></ul>
</div>

  <h3>ğŸ¥¤ Refrigerantes</h3>
  <ul id="refrigerantes"></ul>

  <h3>Adicionais:</h3>
  <input type="text" id="adicionais" placeholder="Digite adicionais">

  <div class="cliente-info">
    <label for="nomeCliente">Nome do Cliente:</label>
    <input type="text" id="nomeCliente" placeholder="Digite seu nome">
    <label for="enderecoCliente">EndereÃ§o:</label>
    <input type="text" id="enderecoCliente" placeholder="Digite o endereÃ§o de entrega">
  </div>

  <h3>ğŸ“ Local de Entrega</h3>
  <select id="localEntrega"></select>

  <h3>ğŸ’³ Formas de Pagamento</h3>
  <ul id="formasPagamentoList"></ul>

  <button id="enviarWhats">Enviar via WhatsApp</button>

  <h3>ğŸ“‹ Pedido Selecionado</h3>
  <ul id="itensPedido"><li>Nenhum item selecionado</li></ul>
</div>

<script>
const diasSemana = ["domingo","segunda-feira","terÃ§a-feira","quarta-feira","quinta-feira","sexta-feira","sÃ¡bado"];
const hojeDate = new Date();
document.getElementById("diaSemana").innerText = diasSemana[hojeDate.getDay()];
const dia = String(hojeDate.getDate()).padStart(2,'0');
const mes = String(hojeDate.getMonth()+1).padStart(2,'0');
const ano = hojeDate.getFullYear();
document.getElementById("dataHoje").innerText = `${dia}/${mes}/${ano}`;

fetch('cardapio.json?t=' + new Date().getTime())
.then(response => response.json())
.then(cardapioFinal => {
    document.getElementById("horarioFuncionamento").textContent = 
        `HorÃ¡rio: ${cardapioFinal.horarioFuncionamento.abertura} - ${cardapioFinal.horarioFuncionamento.fechamento}`;

    let marmitasSelecionadas = []; // array para todas as marmitas
    let refrigerantesSelecionados = [];
    let taxaEntrega = cardapioFinal.locaisEntrega[0].taxa;
    let pagamentoSelecionado = "";

    // =======================
    // SeleÃ§Ã£o de mÃºltiplas marmitas
    // =======================
    const marmitaIconsEl = document.createElement("div");
    marmitaIconsEl.id = "marmitaIcons";
    document.querySelector(".marmita-options").appendChild(marmitaIconsEl);

    const gerarMarmitasInput = document.createElement("input");
    gerarMarmitasInput.type = "number";
    gerarMarmitasInput.min = 1;
    gerarMarmitasInput.value = 1;
    gerarMarmitasInput.style.margin = "10px 0";
    document.querySelector(".marmita-options").appendChild(gerarMarmitasInput);

    const gerarMarmitasBtn = document.createElement("button");
    gerarMarmitasBtn.textContent = "Gerar Marmitas";
    gerarMarmitasBtn.style.marginBottom = "10px";
    document.querySelector(".marmita-options").appendChild(gerarMarmitasBtn);

    let marmitaAtual = 0;

    gerarMarmitasBtn.addEventListener("click", () => {
        const qtd = parseInt(gerarMarmitasInput.value) || 1;
        marmitasSelecionadas = Array.from({length: qtd}, () => ({
            tipo: "",
            carnes: [],
            acompanhamentos: [],
            valor: 0
        }));
        marmitaIconsEl.innerHTML = "";
        for(let i=0; i<qtd; i++){
            const div = document.createElement("div");
            div.classList.add("marmita-icon");
            div.textContent = `Marmita ${String(i+1).padStart(2,'0')}`;
            div.style.cursor = "pointer";
            div.style.display = "inline-block";
            div.style.padding = "5px 10px";
            div.style.border = "1px solid #007BFF";
            div.style.borderRadius = "5px";
            div.style.marginRight = "5px";
            div.addEventListener("click", ()=>{
                marmitaAtual = i;
                selecionarTipoMarmita(i);
                document.querySelectorAll(".marmita-icon").forEach(ic=>ic.style.background="");
                div.style.background="#007BFF";
                div.style.color="#fff";
            });
            marmitaIconsEl.appendChild(div);
        }
    });

    // =======================
    // FunÃ§Ãµes auxiliares
    // =======================
    function selecionarTipoMarmita(index){
        const tiposContainer = document.querySelector(".marmita-options");
        // remove tipos antigos
        tiposContainer.querySelectorAll("label.tipoMarmita").forEach(l=>l.remove());
        Object.keys(cardapioFinal.valoresMarmita).forEach(key=>{
            const label = document.createElement("label");
            label.classList.add("tipoMarmita");
            label.innerHTML = `<input type="radio" name="tipoMarmita${index}" value="${key}"> ${key} - R$${cardapioFinal.valoresMarmita[key]}`;
            label.querySelector("input").addEventListener("change", ()=>{
                marmitasSelecionadas[index].tipo = key;
                marmitasSelecionadas[index].valor = cardapioFinal.valoresMarmita[key];
                // Limite de carnes
                marmitasSelecionadas[index].limiteCarnes = key.includes("01 OpÃ§Ã£o") ? 1 : key.includes("02 OpÃ§Ã£o") ? 2 : 0;
                // PorÃ§Ã£o: desativa acompanhamentos
                const acompEl = document.getElementById("acompanhamentos");
                if(key.includes("PorÃ§Ã£o")){
                    acompEl.querySelectorAll("li").forEach(li=>{
                        li.classList.remove("selected");
                        li.style.pointerEvents = "none";
                        li.style.opacity = "0.5";
                    });
                    marmitasSelecionadas[index].acompanhamentos = [];
                } else {
                    acompEl.querySelectorAll("li").forEach(li=>{
                        li.style.pointerEvents = "auto";
                        li.style.opacity = "1";
                    });
                }
                atualizarPedido();
            });
            tiposContainer.appendChild(label);
        });
    }

    function criarLista(itens, container, tipo){
        container.innerHTML = "";
        itens.forEach(item=>{
            const li = document.createElement("li");
            li.textContent = item;
            li.addEventListener("click", ()=>{
                const selMarmita = marmitasSelecionadas[marmitaAtual];
                if(tipo==="carnes"){
                    if(!li.classList.contains("selected") && selMarmita.carnes.length >= selMarmita.limiteCarnes) return;
                    li.classList.toggle("selected");
                    if(li.classList.contains("selected")) selMarmita.carnes.push(item);
                    else selMarmita.carnes = selMarmita.carnes.filter(x=>x!==item);
                } else if(tipo==="acompanhamentos"){
                    li.classList.toggle("selected");
                    if(li.classList.contains("selected")) selMarmita.acompanhamentos.push(item);
                    else selMarmita.acompanhamentos = selMarmita.acompanhamentos.filter(x=>x!==item);
                }
                atualizarPedido();
            });
            container.appendChild(li);
        });
    }

    function criarListaRefrigerantes(itens, container){
        container.innerHTML = "";
        itens.forEach(i=>{
            const li = document.createElement("li");
            li.textContent = i;
            li.addEventListener("click", ()=>{
                li.classList.toggle("selected");
                const preco = parseFloat(i.split("R$")[1]) || 0;
                if(li.classList.contains("selected")){
                    if(!refrigerantesSelecionados.find(r=>r.nome===i)) refrigerantesSelecionados.push({nome:i, preco});
                } else refrigerantesSelecionados = refrigerantesSelecionados.filter(r=>r.nome!==i);
                atualizarPedido();
            });
            container.appendChild(li);
        });
    }

    // =======================
    // Criar listas iniciais
    // =======================
    const hojeCardapio = cardapioFinal.cardapio[diasSemana[hojeDate.getDay()]] || { carnes: [], acompanhamentos: [] };
    criarLista(hojeCardapio.carnes, document.getElementById("carnes"), "carnes");
    criarLista(hojeCardapio.acompanhamentos, document.getElementById("acompanhamentos"), "acompanhamentos");
    criarListaRefrigerantes(Object.entries(cardapioFinal.refrigerantes).flatMap(([tipo,list])=>list.map(r=>`${tipo} - ${r.nome} R$${r.preco}`)), document.getElementById("refrigerantes"));

    // Locais de entrega
    const localEl = document.getElementById("localEntrega");
    cardapioFinal.locaisEntrega.forEach((loc,i)=>{
        const opt = document.createElement("option");
        opt.value = loc.nome;
        opt.dataset.taxa = loc.taxa;
        opt.textContent = `${loc.nome} - R$${loc.taxa.toFixed(2)}`;
        if(i===0) taxaEntrega = loc.taxa;
        localEl.appendChild(opt);
    });
    localEl.addEventListener("change", ()=>{ taxaEntrega = parseFloat(localEl.selectedOptions[0].dataset.taxa); atualizarPedido(); });

    // Pagamentos
    const formasEl = document.getElementById("formasPagamentoList");
    cardapioFinal.formasPagamento.forEach(f=>{
        const li = document.createElement("li");
        li.textContent = f;
        li.addEventListener("click", ()=>{
            formasEl.querySelectorAll("li").forEach(l=>l.classList.remove("selected"));
            li.classList.add("selected");
            pagamentoSelecionado = f;
            atualizarPedido();
        });
        formasEl.appendChild(li);
    });

    // =======================
    // Atualizar pedido
    // =======================
    function atualizarPedido(){
        const adicionais = document.getElementById("adicionais").value;
        let totalMarmitas = marmitasSelecionadas.reduce((sum,m)=>sum+m.valor,0);
        let totalRef = refrigerantesSelecionados.reduce((sum,r)=>sum+r.preco,0);
        const total = totalMarmitas + totalRef + taxaEntrega;

        const itensEl = document.getElementById("itensPedido");
        itensEl.innerHTML = "";
        marmitasSelecionadas.forEach((m,i)=>{
            if(!m.tipo) return;
            itensEl.innerHTML += `<li>ğŸ± Marmita ${String(i+1).padStart(2,'0')} - ${m.tipo} R$${m.valor}</li>`;
            m.carnes.forEach(c => itensEl.innerHTML += `<li>âœ… ${c}</li>`);
            m.acompanhamentos.forEach(a => itensEl.innerHTML += `<li>âœ… ${a}</li>`);
        });
        refrigerantesSelecionados.forEach(r=>itensEl.innerHTML += `<li>ğŸ¥¤ ${r.nome} R$${r.preco}</li>`);
        if(adicionais) itensEl.innerHTML += `<li>ğŸ“ ${adicionais}</li>`;
        if(pagamentoSelecionado) itensEl.innerHTML += `<li>ğŸ’³ Pagamento: ${pagamentoSelecionado}</li>`;
        itensEl.innerHTML += `<li>ğŸï¸ Taxa de entrega: R$${taxaEntrega.toFixed(2)}</li>`;
        itensEl.innerHTML += `<li>ğŸ’° Total: R$${total.toFixed(2)}</li>`;
    }

    // =======================
    // Enviar WhatsApp
    // =======================
    document.getElementById("enviarWhats").addEventListener("click", ()=>{
        const nome = document.getElementById("nomeCliente").value || "Cliente";
        const endereco = document.getElementById("enderecoCliente").value || "NÃ£o informado";
        const local = document.getElementById("localEntrega").value;
        const adicionais = document.getElementById("adicionais").value || "";

        let msg = `ğŸ½ï¸ *Pedido de ${nome}*\nğŸ“ EndereÃ§o: ${endereco}\nğŸ  Local: ${local}\n\nğŸ“‹ *Itens do Pedido:*\n`;
        let total = 0;
        marmitasSelecionadas.forEach((m,i)=>{
            if(!m.tipo) return;
            msg += `ğŸ± Marmita ${String(i+1).padStart(2,'0')} - ${m.tipo} R$${m.valor}\n`;
            m.carnes.forEach(c => msg += `âœ… ${c}\n`);
            m.acompanhamentos.forEach(a => msg += `âœ… ${a}\n`);
            total += m.valor;
        });
        refrigerantesSelecionados.forEach(r=>{ msg += `ğŸ¥¤ ${r.nome} R$${r.preco}\n`; total+=r.preco; });
        if(adicionais) msg += `ğŸ“ ${adicionais}\n`;
        if(pagamentoSelecionado) msg += `ğŸ’³ Pagamento: ${pagamentoSelecionado}\n`;
        msg += `ğŸï¸ Taxa de entrega: R$${taxaEntrega.toFixed(2)}\n`;
        total += taxaEntrega;
        msg += `ğŸ’° Total: R$${total.toFixed(2)}`;

        window.open(`https://wa.me/+556192633504?text=${encodeURIComponent(msg)}`,"_blank");
    });

});
</script>


