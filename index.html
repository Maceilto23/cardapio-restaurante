<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Card√°pio Interativo</title>
<style>
* { box-sizing: border-box; margin:0; padding:0; }
body { font-family: Arial, sans-serif; background: #f5f5f5; display: flex; flex-direction: column; align-items: center; padding: 10px; }
.cardapio { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 6px 15px rgba(0,0,0,0.2); max-width: 500px; width: 100%; margin-bottom: 20px; }
.logo-container { display: flex; align-items: center; justify-content: flex-start; margin-bottom: 20px; }
.logo-container img { height: 60px; margin-right: 15px; border-radius: 8px; }
.titulo-container h1 { font-size: 1.5rem; color: #007BFF; margin-bottom: 5px; }
.titulo-container h2 { font-size: 1.1rem; color: #555; font-weight: normal; }
.titulo-container h3 { font-size: 1rem; margin-bottom: 10px; color: #333; }
ul { list-style: none; padding: 0; }
li { margin: 5px 0; cursor: pointer; display: flex; align-items: center; padding: 6px 10px; border-radius: 8px; transition: background 0.2s; }
li:hover { background: #f0f0f0; }
.checkbox-fake { width: 22px; height: 22px; border: 2px solid #007BFF; display: flex; align-items: center; justify-content: center; margin-right: 10px; border-radius: 4px; font-weight: bold; color: #fff; background: #007BFF; opacity: 0; transition: opacity 0.2s, transform 0.2s; flex-shrink: 0; }
li.selected .checkbox-fake { opacity: 1; transform: scale(1.1); }
li span { flex: 1; }
#adicionais, input[type="text"], select { width: 100%; padding: 8px; margin-top: 8px; border-radius: 6px; border: 1px solid #ccc; }
#enviarWhats { margin-top: 12px; padding: 10px; background: #25D366; color: #fff; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; font-size: 1rem; }
label { display: block; margin-bottom: 6px; cursor: pointer; }
.marmita-options label { display: block; margin-bottom: 8px; cursor: pointer; }
.marmita-options input { margin-right: 8px; }
@media (max-width: 600px) { 
  .logo-container { flex-direction: column; align-items: center; text-align: center; } 
  .logo-container img { margin-right: 0; margin-bottom: 8px; height: 50px; } 
  .titulo-container h1 { font-size: 1.3rem; } 
  .titulo-container h2 { font-size: 1rem; } 
  #enviarWhats { font-size: 0.95rem; } 
}
</style>
</head>
<body>

<div class="cardapio">
  <div class="logo-container">
    <img src="logo.png" alt="Logo Restaurante">
    <div class="titulo-container">
      <h1>Restaurante Colinas</h1>
      <h2>üçΩÔ∏è Card√°pio de Hoje ‚Äì <span id="diaSemana"></span>, <span id="dataHoje"></span></h2>
      <h3 id="horarioFuncionamento">Hor√°rio: --:-- - --:--</h3>
    </div>
  </div>

  <div class="marmita-options">
    <h3>üç± Escolha o tipo de Marmita</h3>
  </div>

  <h3>üçñ Carnes</h3>
  <ul id="carnes"></ul>

  <h3>ü•ó Acompanhamentos</h3>
  <ul id="acompanhamentos"></ul>

  <h3>ü•§ Refrigerantes</h3>
  <ul id="refrigerantes"></ul>

  <h3>Adicionais:</h3>
  <input type="text" id="adicionais" placeholder="Digite adicionais">

  <div class="cliente-info">
    <label for="nomeCliente">Nome do Cliente:</label>
    <input type="text" id="nomeCliente" placeholder="Digite seu nome">
    <label for="enderecoCliente">Endere√ßo:</label>
    <input type="text" id="enderecoCliente" placeholder="Digite o endere√ßo de entrega">
  </div>

  <h3>üìç Local de Entrega</h3>
  <select id="localEntrega"></select>

  <h3>üí≥ Formas de Pagamento</h3>
  <ul id="formasPagamentoList"></ul>

  <button id="enviarWhats">Enviar via WhatsApp</button>

  <h3>üìã Pedido Selecionado</h3>
  <ul id="itensPedido"><li>Nenhum item selecionado</li></ul>
</div>

document.getElementById("enviarWhats").addEventListener("click", () => {
  // Obter hor√°rio atual
  const agora = new Date();
  const horas = agora.getHours();
  const minutos = agora.getMinutes();

  // Puxar hor√°rio de expediente do card√°pio
  fetch('cardapio.json')
    .then(res => res.json())
    .then(cardapio => {
      const [horaAbertura, minAbertura] = cardapio.horarioFuncionamento.abertura.split(":").map(Number);
      const [horaFechamento, minFechamento] = cardapio.horarioFuncionamento.fechamento.split(":").map(Number);

      const agoraMinutos = horas*60 + minutos;
      const aberturaMinutos = horaAbertura*60 + minAbertura;
      const fechamentoMinutos = horaFechamento*60 + minFechamento;

      if(agoraMinutos < aberturaMinutos || agoraMinutos > fechamentoMinutos){
        alert(`Desculpe! Pedidos s√≥ podem ser feitos entre ${cardapio.horarioFuncionamento.abertura} e ${cardapio.horarioFuncionamento.fechamento}.`);
        return;
      }

      // Montar pedido
      const nome = document.getElementById("nomeCliente").value || "Cliente";
      const endereco = document.getElementById("enderecoCliente").value || "N√£o informado";
      const adicionais = document.getElementById("adicionais").value || "";
      const local = document.getElementById("localEntrega").value;
      const totalRef = refrigerantesSelecionados.reduce((sum,r)=>sum+r.preco,0);
      const total = valorMarmita + taxaEntrega + totalRef;

      // Mensagem WhatsApp
      let msg = `Ol√°! Pedido de ${nome}%0AEndere√ßo: ${endereco}%0ALocal de entrega: ${local}%0A%0AItens:%0A`;
      msg += `${marmita?`- Marmita ${marmita} - R$${valorMarmita}%0A`:""}`;
      pedido.forEach(i => msg += `- ${i}%0A`);
      refrigerantesSelecionados.forEach(r => msg += `- ü•§ ${r.nome}%0A`);
      if(adicionais) msg += `- üìù ${adicionais}%0A`;
      msg += `- üèçÔ∏è Taxa de Entrega: R$${taxaEntrega.toFixed(2)}%0A`;
      msg += `üí∞ Total: R$${total.toFixed(2)}`;

      // Abrir WhatsApp
      window.open(`https://wa.me/+556192633504?text=${encodeURIComponent(msg)}`, "_blank");

      // Gerar p√°gina de impress√£o (opcional)
      const popup = window.open("", "Pedido", "width=400,height=600");
      popup.document.write(`
        <html>
        <head>
          <title>Pedido - Restaurante Colinas</title>
          <style>
            body { font-family: Arial; padding: 20px; }
            h1 { color: #007BFF; }
            ul { list-style: none; padding: 0; }
            li { margin-bottom: 5px; }
          </style>
        </head>
        <body>
          <h1>Restaurante Colinas</h1>
          <h2>Pedido para entrega</h2>
          <p><strong>Cliente:</strong> ${nome}</p>
          <p><strong>Endere√ßo:</strong> ${endereco}</p>
          <p><strong>Local de Entrega:</strong> ${local}</p>
          <p><strong>Itens do Pedido:</strong></p>
          <ul>
            ${marmita?`<li>üç± Marmita ${marmita} - R$${valorMarmita}</li>`:""}
            ${pedido.map(i=>`<li>${i}</li>`).join('')}
            ${refrigerantesSelecionados.map(r=>`<li>ü•§ ${r.nome}</li>`).join('')}
            ${adicionais ? `<li>üìù Adicionais: ${adicionais}</li>` : ''}
          </ul>
          <p><strong>Taxa de Entrega:</strong> R$${taxaEntrega.toFixed(2)}</p>
          <p><strong>Total:</strong> R$${total.toFixed(2)}</p>
          <script>window.print();</script>
        </body>
        </html>
      `);
    });
});
