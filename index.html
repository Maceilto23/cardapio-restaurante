<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CardÃ¡pio Interativo</title>
<style>
* { box-sizing: border-box; margin:0; padding:0; }
body { font-family: Arial, sans-serif; background: #f5f5f5; display:flex; flex-direction:column; align-items:center; padding:10px; }
.cardapio { background:#fff; padding:20px; border-radius:12px; box-shadow:0 6px 15px rgba(0,0,0,0.2); max-width:500px; width:100%; margin-bottom:20px; }
.logo-container { display:flex; align-items:center; justify-content:flex-start; margin-bottom:20px; }
.logo-container img { height:60px; margin-right:15px; border-radius:8px; }
.titulo-container h1 { font-size:1.5rem; color:#007BFF; margin-bottom:5px; }
.titulo-container h2 { font-size:1.1rem; color:#555; font-weight:normal; }
.titulo-container h3 { font-size:1rem; margin-bottom:10px; color:#333; }
ul { list-style:none; padding:0; }
li { margin:5px 0; cursor:pointer; display:flex; align-items:center; padding:6px 10px; border-radius:8px; transition: background 0.2s; }
li:hover { background:#f0f0f0; }
.checkbox-fake { width:22px; height:22px; border:2px solid #007BFF; display:flex; align-items:center; justify-content:center; margin-right:10px; border-radius:4px; font-weight:bold; color:#fff; background:#007BFF; opacity:0; transition:opacity 0.2s, transform 0.2s; flex-shrink:0; }
li.selected .checkbox-fake { opacity:1; transform:scale(1.1); }
li span { flex:1; }
input, select, #adicionais { width:100%; padding:8px; margin-top:8px; border-radius:6px; border:1px solid #ccc; }
button { margin-top:12px; padding:10px; border:none; border-radius:8px; cursor:pointer; font-weight:bold; width:100%; font-size:1rem; }
#gerarMarmitas { background:#007BFF; color:#fff; }
#enviarWhats { background:#25D366; color:#fff; }
.marmita-icons { display:flex; flex-wrap:wrap; gap:8px; margin-top:10px; }
.marmita-icon { width:50px; height:50px; background:#f0f0f0; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; font-weight:bold; border:2px solid #ccc; transition:border 0.2s; }
.marmita-icon.selected { border-color:#007BFF; background:#e0f0ff; }
.marmita-choose { display:none; margin-top:10px; padding:10px; border:1px solid #007BFF; border-radius:8px; background:#f9f9f9; }
.marmita-options label { display:block; margin-bottom:6px; cursor:pointer; }
.marmita-options input { margin-right:8px; }
@media (max-width:600px){.logo-container{flex-direction:column;align-items:center;text-align:center;}.logo-container img{margin-right:0;margin-bottom:8px;height:50px;}.titulo-container h1{font-size:1.3rem;}.titulo-container h2{font-size:1rem;}button{font-size:0.95rem;}}
</style>
</head>
<body>

<div class="cardapio">
  <div class="logo-container">
    <img src="logo.png" alt="Logo Restaurante">
    <div class="titulo-container">
      <h1>Restaurante Colinas</h1>
      <h2>ğŸ½ï¸ CardÃ¡pio de Hoje â€“ <span id="diaSemana"></span>, <span id="dataHoje"></span></h2>
      <h3 id="horarioFuncionamento">HorÃ¡rio: --:-- - --:--</h3>
    </div>
  </div>

  <label for="quantidadeMarmitas">Quantidade de Marmitas:</label>
  <input type="number" id="quantidadeMarmitas" min="1" max="20" value="1">
  <button id="gerarMarmitas">Gerar Marmitas</button>
  <div class="marmita-icons" id="marmitaIcons"></div>

  <div class="marmita-choose" id="marmitaChoose">
    <h3>Escolha os itens da Marmita</h3>
    <div class="marmita-options"></div>
    <h3>ğŸ– Carnes</h3>
    <ul id="carnes"></ul>
    <h3>ğŸ¥— Acompanhamentos</h3>
    <ul id="acompanhamentos"></ul>
  </div>

  <h3>ğŸ¥¤ Refrigerantes</h3>
  <ul id="refrigerantes"></ul>

  <h3>Adicionais:</h3>
  <input type="text" id="adicionais" placeholder="Digite adicionais">

  <div class="cliente-info">
    <label for="nomeCliente">Nome do Cliente:</label>
    <input type="text" id="nomeCliente" placeholder="Digite seu nome">
    <label for="enderecoCliente">EndereÃ§o:</label>
    <input type="text" id="enderecoCliente" placeholder="Digite o endereÃ§o de entrega">
  </div>

  <h3>ğŸ“ Local de Entrega</h3>
  <select id="localEntrega"></select>

  <h3>ğŸ’³ Formas de Pagamento</h3>
  <ul id="formasPagamentoList"></ul>

  <button id="enviarWhats">Enviar via WhatsApp</button>

  <h3>ğŸ“‹ Pedido Selecionado</h3>
  <ul id="itensPedido"><li>Nenhum item selecionado</li></ul>
</div>

<script>
const diasSemana = ["domingo","segunda-feira","terÃ§a-feira","quarta-feira","quinta-feira","sexta-feira","sÃ¡bado"];
const hojeDate = new Date();
document.getElementById("diaSemana").innerText = diasSemana[hojeDate.getDay()];
document.getElementById("dataHoje").innerText = hojeDate.toLocaleDateString();

fetch('cardapio.json?t=' + new Date().getTime())
.then(res => res.json())
.then(cardapio => {
    document.getElementById("horarioFuncionamento").textContent = `HorÃ¡rio: ${cardapio.horarioFuncionamento.abertura} - ${cardapio.horarioFuncionamento.fechamento}`;

    let marmitas = [], refrigerantes = [], taxaEntrega = cardapio.locaisEntrega[0].taxa, pagamento = "";
    const marmitaIconsEl = document.getElementById("marmitaIcons");
    const marmitaChooseEl = document.getElementById("marmitaChoose");

    function criarLista(itens, container, tipo){
        container.innerHTML = "";
        itens.forEach(item=>{
            const li = document.createElement("li");
            li.innerHTML = `<div class="checkbox-fake">âœ”</div><span>${item}</span>`;
            li.addEventListener("click", ()=>{
                li.classList.toggle("selected");
                const sel = marmitas[marmitaAtual];
                if(tipo==="carnes"){
                    if(li.classList.contains("selected")) {
                        if(sel.carnes.length<sel.limiteCarnes) sel.carnes.push(item);
                        else li.classList.remove("selected");
                    } else sel.carnes = sel.carnes.filter(x=>x!==item);
                } else if(tipo==="acompanhamentos"){
                    if(li.classList.contains("selected")) sel.acompanhamentos.push(item);
                    else sel.acompanhamentos = sel.acompanhamentos.filter(x=>x!==item);
                } else if(tipo==="refrigerantes"){
                    const preco = parseFloat(item.split("R$")[1]) || 0;
                    if(li.classList.contains("selected")){
                        if(!refrigerantes.find(r=>r.nome===item)) refrigerantes.push({nome:item, preco});
                    } else refrigerantes = refrigerantes.filter(r=>r.nome!==item);
                }
                atualizarPedido();
            });
            container.appendChild(li);
        });
    }

    function gerarMarmitas(){
        const qtd = parseInt(document.getElementById("quantidadeMarmitas").value) || 1;
        marmitas = Array.from({length:qtd},()=>({tipo:"", carnes:[], acompanhamentos:[], valor:0, limiteCarnes:2}));
        marmitaIconsEl.innerHTML = "";
        marmitaChooseEl.style.display = qtd>0 ? "block":"none";
        for(let i=0;i<qtd;i++){
            const div = document.createElement("div");
            div.classList.add("marmita-icon");
            div.textContent = i+1;
            div.addEventListener("click", ()=>{ marmitaAtual=i; selecionarTipoMarmita(i); atualizarSelecaoIcones(); });
            marmitaIconsEl.appendChild(div);
        }
        marmitaAtual=0;
        selecionarTipoMarmita(0);
        atualizarSelecaoIcones();
    }

    function atualizarSelecaoIcones(){
        document.querySelectorAll(".marmita-icon").forEach((d,i)=>d.classList.toggle("selected",i===marmitaAtual));
    }

    function selecionarTipoMarmita(index){
        const tiposContainer = document.querySelector(".marmita-options");
        tiposContainer.innerHTML = "";
        Object.keys(cardapio.valoresMarmita).forEach(t=>{
            const label = document.createElement("label");
            label.innerHTML = `<input type="radio" name="tipo${index}" value="${t}"> ${t} - R$${cardapio.valoresMarmita[t]}`;
            label.querySelector("input").addEventListener("change", ()=>{
                marmitas[index].tipo=t;
                marmitas[index].valor=cardapio.valoresMarmita[t];
                marmitas[index].limiteCarnes = t.includes("01 OpÃ§Ã£o") ? 1 : t.includes("02 OpÃ§Ã£o") ? 2 : 2;
                atualizarPedido();
            });
            tiposContainer.appendChild(label);
        });
    }

    // Carnes e acompanhamentos
    const hojeCardapio = cardapio.cardapio[diasSemana[hojeDate.getDay()]] || {carnes:[], acompanhamentos:[]};
    criarLista(hojeCardapio.carnes, document.getElementById("carnes"), "carnes");
    criarLista(hojeCardapio.acompanhamentos, document.getElementById("acompanhamentos"), "acompanhamentos");
    criarLista(Object.entries(cardapio.refrigerantes).flatMap(([tipo,list])=>list.map(r=>`${tipo} - ${r.nome} R$${r.preco}`)), document.getElementById("refrigerantes"), "refrigerantes");

    // Locais de entrega
    const localEl = document.getElementById("localEntrega");
    cardapio.locaisEntrega.forEach((l,i)=>localEl.innerHTML+=`<option value="${l.nome}" data-taxa="${l.taxa}">${l.nome} - R$${l.taxa.toFixed(2)}</option>`);
    localEl.addEventListener("change", ()=>{ taxaEntrega=parseFloat(localEl.selectedOptions[0].dataset.taxa); atualizarPedido(); });

    // Pagamentos
    const formasEl = document.getElementById("formasPagamentoList");
    cardapio.formasPagamento.forEach(f=>{
        const li=document.createElement("li"); li.textContent=f;
        li.addEventListener("click", ()=>{ formasEl.querySelectorAll("li").forEach(l=>l.classList.remove("selected")); li.classList.add("selected"); pagamento=f; atualizarPedido(); });
        formasEl.appendChild(li);
    });

    document.getElementById("gerarMarmitas").addEventListener("click", gerarMarmitas);

    function atualizarPedido(){
        const adicionais = document.getElementById("adicionais").value;
        let total = marmitas.reduce((s,m)=>s+m.valor,0) + refrigerantes.reduce((s,r)=>s+r.preco,0) + taxaEntrega;
        const ul = document.getElementById("itensPedido"); ul.innerHTML="";
        marmitas.forEach((m,i)=>{
            if(!m.tipo) return;
            ul.innerHTML+=`<li>ğŸ± Marmita ${i+1} - ${m.tipo} R$${m.valor}</li>`;
            m.carnes.forEach(c=>ul.innerHTML+=`<li>âœ… ${c}</li>`);
            m.acompanhamentos.forEach(a=>ul.innerHTML+=`<li>âœ… ${a}</li>`);
        });
        refrigerantes.forEach(r=>ul.innerHTML+=`<li>ğŸ¥¤ ${r.nome} R$${r.preco}</li>`);
        if(adicionais) ul.innerHTML+=`<li>ğŸ“ ${adicionais}</li>`;
        if(pagamento) ul.innerHTML+=`<li>ğŸ’³ Pagamento: ${pagamento}</li>`;
        ul.innerHTML+=`<li>ğŸï¸ Taxa de entrega: R$${taxaEntrega.toFixed(2)}</li>`;
        ul.innerHTML+=`<li>ğŸ’° Total: R$${total.toFixed(2)}</li>`;
    }

    document.getElementById("enviarWhats").addEventListener("click", ()=>{
        const nome=document.getElementById("nomeCliente").value||"Cliente";
        const endereco=document.getElementById("enderecoCliente").value||"NÃ£o informado";
        const local=localEl.value;
        const adicionais=document.getElementById("adicionais").value||"";
        let msg=`ğŸ½ï¸ *Pedido de ${nome}*\nğŸ“ EndereÃ§o: ${endereco}\nğŸ  Local: ${local}\n\nğŸ“‹ *Itens do Pedido:*\n`;
        let total=0;
        marmitas.forEach((m,i)=>{
            if(!m.tipo) return;
            msg+=`ğŸ± Marmita ${i+1} - ${m.tipo} R$${m.valor}\n`;
            m.carnes.forEach(c=>msg+=`âœ… ${c}\n`);
            m.acompanhamentos.forEach(a=>msg+=`âœ… ${a}\n`);
            total+=m.valor;
        });
        refrigerantes.forEach(r=>{msg+=`ğŸ¥¤ ${r.nome} R$${r.preco}\n`; total+=r.preco;});
        if(adicionais) msg+=`ğŸ“ ${adicionais}\n`;
        if(pagamento) msg+=`ğŸ’³ Pagamento: ${pagamento}\n`;
        msg+=`ğŸï¸ Taxa de entrega: R$${taxaEntrega.toFixed(2)}\n`; total+=taxaEntrega;
        msg+=`ğŸ’° Total: R$${total.toFixed(2)}`;
        window.open(`https://wa.me/+556192633504?text=${encodeURIComponent(msg)}`,"_blank");
    });

});
</script>

</body>
</html>
