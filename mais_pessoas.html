<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Card√°pio Interativo</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:Arial,sans-serif;background:#f5f5f5;display:flex;flex-direction:column;align-items:center;padding:10px}
.cardapio{background:#fff;padding:20px;border-radius:12px;box-shadow:0 6px 15px rgba(0,0,0,0.2);max-width:500px;width:100%;margin-bottom:20px}
.logo-container{display:flex;align-items:center;justify-content:flex-start;margin-bottom:20px}
.logo-container img{height:60px;margin-right:15px;border-radius:8px}
.titulo-container h1{font-size:1.5rem;color:#007BFF;margin-bottom:5px}
.titulo-container h2{font-size:1.1rem;color:#555;font-weight:normal}
.titulo-container h3{font-size:1rem;margin-bottom:10px;color:#333}
ul{list-style:none;padding:0}
li{margin:5px 0;cursor:pointer;display:flex;align-items:center;padding:6px 10px;border-radius:8px;transition:background 0.2s}
li:hover{background:#f0f0f0}
.checkbox-fake{width:22px;height:22px;border:2px solid #007BFF;display:flex;align-items:center;justify-content:center;margin-right:10px;border-radius:4px;font-weight:bold;color:#fff;background:#007BFF;opacity:0;transition:opacity 0.2s,transform 0.2s;flex-shrink:0}
li.selected .checkbox-fake{opacity:1;transform:scale(1.1)}
li span{flex:1}
select,input[type="text"],input[type="number"]{width:100%;padding:8px;margin-top:8px;border-radius:6px;border:1px solid #ccc}
button{cursor:pointer;font-weight:bold;border:none;border-radius:8px}
#adicionarPedido{margin:10px 0;padding:10px;width:100%;background:#007BFF;color:#fff}
#enviarWhats{margin-top:15px;padding:12px;background:#25D366;color:#fff;width:100%;font-size:1rem}
.pedido-individual{border:1px solid #ccc;padding:10px;margin:10px 0;border-radius:8px;background:#f9f9f9}
.pedido-individual h4{margin-bottom:5px}
@media(max-width:600px){
 .logo-container{flex-direction:column;align-items:center;text-align:center}
 .logo-container img{margin-right:0;margin-bottom:8px;height:50px}
 .titulo-container h1{font-size:1.3rem}
 .titulo-container h2{font-size:1rem}
 #enviarWhats,#adicionarPedido{font-size:.95rem}
}
</style>
</head>
<body>

<div class="cardapio">
  <div class="logo-container">
    <img src="logo.png" alt="Logo Restaurante">
    <div class="titulo-container">
      <h1>Restaurante Colinas</h1>
      <h2>üçΩÔ∏è Card√°pio de Hoje ‚Äì <span id="diaSemana"></span>, <span id="dataHoje"></span></h2>
      <h3 id="horarioFuncionamento">Hor√°rio: --:-- - --:--</h3>
    </div>
  </div>

  <label for="endereco">üìç Endere√ßo de Entrega (√∫nico para todos os pedidos)</label>
  <input type="text" id="endereco" placeholder="Digite o endere√ßo de entrega">

  <button id="adicionarPedido">‚ûï Adicionar Pedido de Outra Pessoa</button>

  <div id="pedidosContainer"></div>

  <h3>üìã Pedidos Selecionados</h3>
  <div id="listaPedidos"></div>

  <label for="formaPagamento">üí≥ Forma de Pagamento</label>
  <select id="formaPagamento"></select>

  <button id="enviarWhats">üì≤ Enviar Pedidos via WhatsApp</button>
</div>

<script>
const pedidos = [];

// carregar dados do card√°pio
let dadosCardapio = null;
fetch('cardapio.json')
  .then(res => res.json())
  .then(data => {
    dadosCardapio = data;
    inicializar();
  })
  .catch(err => alert("Erro ao carregar cardapio.json: " + err));

// inicializa p√°gina
function inicializar(){
  const hoje = new Date();
  const dias = ["domingo","segunda-feira","ter√ßa-feira","quarta-feira","quinta-feira","sexta-feira","s√°bado"];
  const diaNome = dias[hoje.getDay()];
  const diaNum = String(hoje.getDate()).padStart(2,"0");
  const mesNum = String(hoje.getMonth()+1).padStart(2,"0");
  const ano = hoje.getFullYear();
  document.getElementById('diaSemana').textContent = diaNome;
  document.getElementById('dataHoje').textContent = `${diaNum}/${mesNum}/${ano}`;

  const {abertura,fechamento} = dadosCardapio.horarioFuncionamento;
  document.getElementById('horarioFuncionamento').textContent = `Hor√°rio: ${abertura} - ${fechamento}`;

  const selPag = document.getElementById('formaPagamento');
  dadosCardapio.formasPagamento.forEach(p=>{
    const opt = document.createElement('option');
    opt.value=p; opt.textContent=p;
    selPag.appendChild(opt);
  });

  document.getElementById('adicionarPedido').addEventListener('click',()=>criarPedido(diaNome));
  document.getElementById('enviarWhats').addEventListener('click',enviarWhats);
}

// cria formul√°rio de um pedido individual
function criarPedido(diaSemana){
  const pedidoIdx = pedidos.length;

  const div = document.createElement('div');
  div.className = 'pedido-individual';

  const titulo = document.createElement('h4');
  titulo.textContent = `Pedido ${pedidoIdx+1}`;
  div.appendChild(titulo);

  // tipo marmita
  const marmitaLabel = document.createElement('label');
  marmitaLabel.textContent = 'üç± Tipo de Marmita';
  div.appendChild(marmitaLabel);

  const marmitaSelect = document.createElement('select');
  for(const [tipo,valor] of Object.entries(dadosCardapio.valoresMarmita)){
    const opt = document.createElement('option');
    opt.value = tipo;
    opt.textContent = `${tipo} - R$${valor}`;
    marmitaSelect.appendChild(opt);
  }
  div.appendChild(marmitaSelect);

  // carnes
  const carnesLabel = document.createElement('label');
  carnesLabel.textContent = 'ü•© Carnes';
  div.appendChild(carnesLabel);

  const carnesUL = document.createElement('ul');
  dadosCardapio.cardapio[diaSemana].carnes.forEach(c=>{
    const li = document.createElement('li');
    li.innerHTML = `<div class="checkbox-fake">‚úî</div><span>${c}</span>`;
    li.addEventListener('click',()=>li.classList.toggle('selected'));
    carnesUL.appendChild(li);
  });
  div.appendChild(carnesUL);

  // acompanhamentos
  const acompLabel = document.createElement('label');
  acompLabel.textContent = 'üçö Acompanhamentos';
  div.appendChild(acompLabel);

  const acompUL = document.createElement('ul');
  dadosCardapio.cardapio[diaSemana].acompanhamentos.forEach(a=>{
    const li = document.createElement('li');
    li.innerHTML = `<div class="checkbox-fake">‚úî</div><span>${a}</span>`;
    li.addEventListener('click',()=>li.classList.toggle('selected'));
    acompUL.appendChild(li);
  });
  div.appendChild(acompUL);

  // refrigerantes
  const refriLabel = document.createElement('label');
  refriLabel.textContent = 'ü•§ Refrigerante (opcional)';
  div.appendChild(refriLabel);

  const refriSelect = document.createElement('select');
  const optNenhum = document.createElement('option');
  optNenhum.value = ''; optNenhum.textContent='Nenhum';
  refriSelect.appendChild(optNenhum);

  for(const [tipo,lista] of Object.entries(dadosCardapio.refrigerantes)){
    const group = document.createElement('optgroup');
    group.label = tipo;
    lista.forEach(r=>{
      const opt = document.createElement('option');
      opt.value = `${r.nome} (${tipo})`;
      opt.textContent = `${r.nome} ${tipo} - R$${r.preco}`;
      group.appendChild(opt);
    });
    refriSelect.appendChild(group);
  }
  div.appendChild(refriSelect);

  // local de entrega
  const localLabel = document.createElement('label');
  localLabel.textContent = 'üìç Local de Entrega';
  div.appendChild(localLabel);

  const localSelect = document.createElement('select');
  dadosCardapio.locaisEntrega.forEach(l=>{
    const opt = document.createElement('option');
    opt.value = l.nome;
    opt.textContent = `${l.nome} - Taxa R$${l.taxa}`;
    localSelect.appendChild(opt);
  });
  div.appendChild(localSelect);

  pedidos.push({marmitaSelect,carnesUL,acompUL,refriSelect,localSelect});
  document.getElementById('pedidosContainer').appendChild(div);

  atualizarListaPedidos();
}

// atualiza a lista resumida de pedidos
function atualizarListaPedidos(){
  const lista = document.getElementById('listaPedidos');
  lista.innerHTML='';
  pedidos.forEach((p,i)=>{
    const carnes = [...p.carnesUL.querySelectorAll('li.selected span')].map(s=>s.textContent).join(', ');
    const acomp = [...p.acompUL.querySelectorAll('li.selected span')].map(s=>s.textContent).join(', ');
    const refri = p.refriSelect.value || 'Nenhum';
    const local = p.localSelect.value;
    const tipo = p.marmitaSelect.value;

    const resumo = document.createElement('div');
    resumo.textContent = `Pedido ${i+1}: ${tipo} | Carnes: ${carnes} | Acompanhamentos: ${acomp} | Refri: ${refri} | Local: ${local}`;
    lista.appendChild(resumo);
  });
}

// monta mensagem e abre WhatsApp
function enviarWhats(){
  atualizarListaPedidos();
  const endereco = document.getElementById('endereco').value.trim();
  if(!endereco){alert('Digite o endere√ßo de entrega!');return;}

  const pagamento = document.getElementById('formaPagamento').value;
  let msg = `üçΩÔ∏è *Pedidos Restaurante Colinas*\nüìç Endere√ßo: ${endereco}\nüí≥ Pagamento: ${pagamento}\n\n`;

  pedidos.forEach((p,i)=>{
    const carnes = [...p.carnesUL.querySelectorAll('li.selected span')].map(s=>s.textContent).join(', ')||'Nenhuma';
    const acomp = [...p.acompUL.querySelectorAll('li.selected span')].map(s=>s.textContent).join(', ')||'Nenhum';
    const refri = p.refriSelect.value || 'Nenhum';
    const local = p.localSelect.value;
    const tipo = p.marmitaSelect.value;
    msg += `üîπ Pedido ${i+1}\nüç± ${tipo}\nü•© ${carnes}\nüçö ${acomp}\nü•§ ${refri}\nüìç ${local}\n\n`;
  });

  const url = `https://wa.me/?text=${encodeURIComponent(msg)}`;
  window.open(url,'_blank');
}
</script>
</body>
</html>
